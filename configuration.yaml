
# Configure a default setup of Home Assistant (frontend, api, etc)
default_config:

# Text to speech
tts:
  - platform: google_translate

group: !include groups.yaml
automation: !include automations.yaml
script: !include scripts.yaml
scene: !include scenes.yaml

############################################
### CONFIGURAÇÃO HTTPS
############################################
http:
    base_url: https://antoniha.duckdns.org
    ssl_certificate: /ssl/fullchain.pem
    ssl_key: /ssl/privkey.pem
    
############################################
### INTEGRAÇÃO SONOFF
############################################
sonoff:
    username: marco.antoni910@gmail.com
    password: !secret ewelinkapp
    reload: always  # update device list every time HA starts
    force_update: [temperature, power]
    scan_interval: '00:0:02'  # (optional) default 5 minutes
    sensors: [temperature, humidity, power, current, voltage]
  


############################################
### SENSORES
############################################
sensor:
  # temperatura externa
  - platform: template
    sensors:
        norwegian_temperature:
            friendly_name: "Temperatura"
            unit_of_measurement: '°C'
            value_template: "{{ state_attr('weather.home', 'temperature') }}"
    # umidade relativa do ar
  - platform: template      
    sensors:
        umidade:
            friendly_name: "Umidade"
            unit_of_measurement: '%'
            value_template: "{{ state_attr('weather.home', 'humidity') }}"
    
    # monitoramento SNMP roteador
    # https://forum.homeassistantbrasil.com.br/t/obtendo-o-trafego-da-wan-do-roteador-via-snmp-tempo-real/92
  - platform: snmp
    name: 'ether5_wan_in'
    host: 192.168.1.254
    baseoid: 1.3.6.1.2.1.31.1.1.1.6.5
    community: 'public'
    version: '2c'
  - platform: snmp
    name: 'ether5_wan_out'
    host: 192.168.1.254
    baseoid: 1.3.6.1.2.1.31.1.1.1.10.5
    community: 'public'
    version: '2c'

  - platform: template
    sensors:
        internet_speed_in:
            friendly_name: 'Download'
            value_template: '{{ ((states.input_number.internet_delta_in.state | float ) / 1000000 ) | round(2) }}'
            unit_of_measurement: 'Mbps'
            icon_template: 'mdi:download-network'
        internet_speed_out:
            friendly_name: 'Upload'
            value_template: '{{ ((states.input_number.internet_delta_out.state | float ) / 1000000 ) | round(2) }}'
            unit_of_measurement: 'Mbps'
            icon_template: 'mdi:upload-network'

  - platform: statistics
    name: 'WAN In'
    entity_id: sensor.internet_speed_in
    max_age:
        hours: 12
  - platform: statistics
    name: 'WAN Out'
    entity_id: sensor.internet_speed_out
    max_age:
        hours: 12
    
input_number:
    internet_delta_in:
        initial: 0
        min: 0
        max: 1000000000000
        mode: slider
    internet_delta_out:
        initial: 0
        min: 0
        max: 1000000000000
        mode: slider
#  monitoramento SNMP roteador
    
############################################
### INTEGRAÇÃO BROADLINK
############################################
switch:
  - platform: broadlink
    mac: 'EC:0B:AE:3D:DB:A3'
    switches:
      # comandos receptor digital
      - name: "Receptor"
        command_on: 'JgBIAAABJJYRFBEUERQQFREVDxYQFhAWDjoROBE5ExMQOhA6EDoPOxAUERQSORA6EDkRFRA6EBYPOhA5EBYQFBEWDzoQFg85EQANBQ=='
        command_off: 'JgBIAAABJJYRFBEUERQQFREVDxYQFhAWDjoROBE5ExMQOhA6EDoPOxAUERQSORA6EDkRFRA6EBYPOhA5EBYQFBEWDzoQFg85EQANBQ=='
      - name: "receptor_volume_up"
        command_on: 'JgBIAAABJpMUEhEUERQRFBMSEhQRFBITEzcSOBE5ERQROBI4EzgSOBEUETkROBIUETkSExE4ExMTNxITEhMUNhITEzYTExQ1FAANBQ=='
      - name: "receptor_volume_down"
        command_on: 'JgBIAAABJpQRFBEVEBUQFBIUERUQFRAVETgRORE5EBYPOhA6ETkRORE4EhQPOxAVEDkRFRE5EBUSFBA6EBUQOBIVDjsRFRA5EgANBQ=='
        
      - name: "receptor_channel_up"
        command_on: 'JgBIAAABJZURFRETEhQRFBEVDxURFBEUETkSNxI5EhITORA5ETkRORE5ERQROBE5ETkRFRA6ERQSExI4ERQSFBAVEDkTExA4EgANBQ=='
      - name: "receptor_channel_down"
        command_on: 'JgBQAAABJJYRFBEVEBUPFg8WERQRFRAUETkRORE4EhUPOxA5EDkSOBE5EjgQOhA7EDkQFRAWDxURFRAWDxURFBAVEjcSOhE4EAAFdAABJUwQAA0F'
      - name: "receptor_mute"
        command_on: 'JgBQAAABJJYRFBAVERUQFBIUDxYPFRIUETkQOhE3ExQQOhA5EToQORAWDzoQOhA6EDoQFhAUERUQOREUEhUPFBEWEDoPOhA5EgAFcgABJ0oRAA0F'
      - name: "receptor_info"
        command_on: 'JgBIAAABI5USFREUEBQTFBAVERQQFg8WEDoPOhE4EhUQOBI5EDoQORAWEBUQOREVERQRFBA6EBYQORA5ERUQPA86DzoPFhE5EAANBQ=='
      - name: "receptor_home"
        command_on: 'JgBIAAABIpYRFBAXDxUSFQ4VEBUTEhEVETkQOhA5ERYQOBI4ETgSORAVEhMRFRAWDzkRFBEVERUPORE5ETkROREWDzoRORE4EgANBQ=='
        
      - name: "TV da Sala"
        command_on: 'JgBQAAABJJQSExITEhMSExITEhISExITEjgSEhM3EjgSOBI3EhMSOBI3ExMRExITEhMSExISEhMSExI4EjcSOBI4EjgROBI4EgAFaAABJksSAA0F'
        command_off: 'JgBQAAABJJQSExITEhMSExITEhISExITEjgSEhM3EjgSOBI3EhMSOBI3ExMRExITEhMSExISEhMSExI4EjcSOBI4EjgROBI4EgAFaAABJksSAA0F'

############################################
### INTEGRAÇÃO TELEGRAM
############################################
telegram_bot:
  - platform: polling
    api_key: "1240487662:AAGOgH0rc25oczICcrlwI9YYMx0bzV0WEOw"
    allowed_chat_ids:
      - 220034727 # example: 123456789 for the chat_id of a user

# notificações Marco
notify:
  - platform: telegram
    name: NOTIFIER_MARCO
    chat_id: 220034727